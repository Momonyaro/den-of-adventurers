[gd_scene load_steps=30 format=3 uid="uid://f64ofd2jr8sn"]

[ext_resource type="Script" path="res://Scripts/Data/DataContainer.gd" id="1_8246l"]
[ext_resource type="Script" path="res://Scripts/Data/TimerContainer.gd" id="2_dls8v"]
[ext_resource type="Script" path="res://Scripts/Managers/GameManager.gd" id="2_tfev1"]
[ext_resource type="Script" path="res://Scripts/Managers/SettingsManager.gd" id="3_pb3he"]
[ext_resource type="Script" path="res://Scripts/Managers/AdventurerManager.gd" id="3_q8kab"]
[ext_resource type="Script" path="res://Scripts/Managers/ActivityManager.gd" id="3_ue1fi"]
[ext_resource type="Script" path="res://Scripts/Activities/BedActivity.gd" id="4_a3onc"]
[ext_resource type="Script" path="res://Scripts/Data/DataStore.gd" id="4_fckrr"]
[ext_resource type="Script" path="res://Scripts/Managers/AgentManager.gd" id="4_uo78h"]
[ext_resource type="FontFile" uid="uid://dinw4r8yhno6k" path="res://Fonts/ArgentPixelCF-Regular.otf" id="5_lyn1g"]
[ext_resource type="Script" path="res://Scripts/Managers/RequestManager.gd" id="6_abixe"]
[ext_resource type="Script" path="res://Scripts/Activities/LeaveActivity.gd" id="6_pdokr"]
[ext_resource type="PackedScene" uid="uid://daoo1s5dlp1si" path="res://Scenes/UI/ui.tscn" id="6_xnocw"]
[ext_resource type="PackedScene" uid="uid://06sse8nkfhmp" path="res://Models/bed.glb" id="9_cqd85"]
[ext_resource type="Script" path="res://addons/persistence_node/persistence_node.gd" id="12_ebu0n"]
[ext_resource type="PackedScene" uid="uid://cspjx814ecba8" path="res://Models/chair.glb" id="16_d6hij"]
[ext_resource type="PackedScene" uid="uid://kv0j1ytnhqui" path="res://Models/dining_table.glb" id="17_1jl0l"]

[sub_resource type="Gradient" id="Gradient_6sds3"]
offsets = PackedFloat32Array(0, 0.569288, 1)
colors = PackedColorArray(0.180392, 0.223529, 0.298039, 1, 0.469994, 0.54512, 0.701762, 0.976471, 1, 1, 1, 0.54902)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_ovn72"]
gradient = SubResource("Gradient_6sds3")

[sub_resource type="Curve" id="Curve_gyyo7"]
max_value = 1.2
_data = [Vector2(0, 0), 0.0, -0.0337155, 0, 0, Vector2(0.846607, 1.2), -0.445042, -0.445042, 0, 0, Vector2(1, 0), -22.1941, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_6wmik"]
curve = SubResource("Curve_gyyo7")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_v047h"]
lifetime_randomness = 0.13
particle_flag_align_y = true
particle_flag_rotate_y = true
direction = Vector3(1.25, 2.08165e-12, 2.08165e-12)
spread = 70.38
gravity = Vector3(2.08165e-12, 1, 2.08165e-12)
initial_velocity_min = 0.06
initial_velocity_max = 0.1
angle_min = -17.9
angle_max = 26.8
scale_curve = SubResource("CurveTexture_6wmik")
color = Color(0.180392, 0.223529, 0.298039, 1)
color_ramp = SubResource("GradientTexture1D_ovn72")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_hj15a"]
transparency = 1
shading_mode = 0
albedo_color = Color(0.729412, 0.776471, 0.854902, 0.831373)

[sub_resource type="TextMesh" id="TextMesh_5yyk0"]
material = SubResource("StandardMaterial3D_hj15a")
uv2_padding = 1.46
text = "Z"
font = ExtResource("5_lyn1g")
font_size = 24
depth = 0.02

[sub_resource type="Environment" id="Environment_wun1a"]
background_mode = 1
background_color = Color(0.505882, 0.807843, 0.509804, 1)
ambient_light_source = 2
ambient_light_color = Color(0.290196, 0.337255, 0.439216, 1)
ambient_light_energy = 0.0
tonemap_white = 1.74

[sub_resource type="NavigationMesh" id="NavigationMesh_av4e2"]
vertices = PackedVector3Array(0, 0.0199981, -4, 0.25, 0.0199981, -3.5, 1.25, 0.0199981, -4, -2.5, 0.0199981, -4.25, 0, 0.0199981, -4, 1.25, 0.0199981, -4, 1, 0.0199981, -9.25, -2.5, 0.0199981, -4.25, 1, 0.0199981, -9.25, -9.25, 0.0199981, -9.25, -9.25, 0.0199981, -2.75, -9.25, 0.0199981, -2.75, -3, 0.0199981, -2.75, -2.5, 0.0199981, -4.25, 1, 0.0199981, -9.25, 1.25, 0.0199981, -4, 2.5, 0.0199981, -3.75, 9.25, 0.0199981, -3.75, 9.25, 0.0199981, -9.25, 2.75, 0.0199981, -1.75, 2.75, 0.0199981, -0.25, 3.5, 0.0199981, 0.5, 9.25, 0.0199981, 1.25, 9.25, 0.0199981, -3.75, 3, 0.0199981, -3.25, 9.25, 0.0199981, -3.75, 2.5, 0.0199981, -3.75, 3, 0.0199981, -3.25, 3.5, 0.0199981, 0.5, 3.5, 0.0199981, 1.25, 9.25, 0.0199981, 1.25, 2.75, 0.0199981, -0.25, 2.75, 0.0199981, -1.75, 2.25, 0.0199981, -1.25, 1.5, 0.0199981, -0.5, 2.75, 0.0199981, -0.25, 2.25, 0.0199981, -1.25, 0.25, 0.0199981, -1.75, 0, 0.0199981, -1.25, -3, 0.0199981, -2, -3, 0.0199981, -2.75, -9.25, 0.0199981, -2.75, -1.25, 0.0199981, 1, -0.75, 0.0199981, 0.25, -1.5, 0.0199981, -1.25, -3, 0.0199981, -2, -9.25, 0.0199981, -2.75, -9.25, 0.0199981, 1, -0.75, 0.0199981, 0.25, 0.75, 0.0199981, 0.5, 1.5, 0.0199981, -0.5, 0, 0.0199981, -1.25, -1.5, 0.0199981, -1.25, -0.25, 0.0199981, 9.25, -0.25, 0.0199981, 3.25, -1.5, 0.0199981, 2.25, -9.25, 0.0199981, 1, -9.25, 0.0199981, 9.25, -1.5, 0.0199981, 2.25, -1.25, 0.0199981, 1, -9.25, 0.0199981, 1, 2.5, 0.0199981, 2.75, 1, 0.0199981, 2.25, -0.25, 0.0199981, 3.25, -0.25, 0.0199981, 9.25, 9.25, 0.0199981, 1.25, 3.5, 0.0199981, 1.25, 2.5, 0.0199981, 2.75, -0.25, 0.0199981, 9.25, 9.25, 0.0199981, 9.25)
polygons = [PackedInt32Array(2, 1, 0), PackedInt32Array(4, 3, 5), PackedInt32Array(5, 3, 6), PackedInt32Array(10, 9, 7), PackedInt32Array(7, 9, 8), PackedInt32Array(13, 12, 11), PackedInt32Array(15, 14, 16), PackedInt32Array(16, 14, 17), PackedInt32Array(17, 14, 18), PackedInt32Array(20, 19, 21), PackedInt32Array(21, 19, 24), PackedInt32Array(21, 24, 23), PackedInt32Array(21, 23, 22), PackedInt32Array(27, 26, 25), PackedInt32Array(30, 29, 28), PackedInt32Array(33, 32, 31), PackedInt32Array(35, 34, 36), PackedInt32Array(36, 34, 37), PackedInt32Array(37, 34, 38), PackedInt32Array(41, 40, 39), PackedInt32Array(43, 42, 44), PackedInt32Array(44, 42, 45), PackedInt32Array(45, 42, 47), PackedInt32Array(45, 47, 46), PackedInt32Array(50, 49, 51), PackedInt32Array(51, 49, 48), PackedInt32Array(51, 48, 52), PackedInt32Array(54, 53, 55), PackedInt32Array(55, 53, 57), PackedInt32Array(55, 57, 56), PackedInt32Array(60, 59, 58), PackedInt32Array(62, 61, 63), PackedInt32Array(63, 61, 64), PackedInt32Array(66, 65, 67), PackedInt32Array(67, 65, 69), PackedInt32Array(67, 69, 68)]
cell_height = 0.01
agent_height = 1.0
agent_radius = 0.7

[sub_resource type="PlaneMesh" id="PlaneMesh_wambb"]

[sub_resource type="BoxMesh" id="BoxMesh_0jipx"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_8m8ew"]
albedo_color = Color(0.27451, 0.27451, 0.27451, 1)

[node name="Root" type="Node3D"]
script = ExtResource("1_8246l")

[node name="SettingsMngr" type="Node" parent="."]
script = ExtResource("3_pb3he")

[node name="Settings" type="Node" parent="SettingsMngr"]
script = ExtResource("12_ebu0n")
folder_name = ""
file_name = "settings"
mode = 1

[node name="DataStore" type="Node" parent="."]
script = ExtResource("4_fckrr")

[node name="HOT_DRIVE" type="Node" parent="DataStore"]
script = ExtResource("12_ebu0n")
file_name = "save"
store_objects = true

[node name="Game" type="Node" parent="."]
script = ExtResource("2_tfev1")

[node name="Activities" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("3_ue1fi")

[node name="BedActivity" type="Node3D" parent="Activities"]
transform = Transform3D(0.613582, 0, 0.789631, 0, 1, 0, -0.789631, 0, 0.613582, 2.611, 0.1, -1.828)
script = ExtResource("4_a3onc")

[node name="START_POINT" type="Node3D" parent="Activities/BedActivity"]
transform = Transform3D(0.999999, 0, -3.8743e-07, 0, 0.999999, 0, 8.9407e-08, 0, 0.999999, -0.644564, -0.0831673, 0.261748)

[node name="ACTIVITY_POINT" type="Node3D" parent="Activities/BedActivity"]
transform = Transform3D(1, 0, -2.38419e-07, 0, 1, 0, 5.96046e-08, 0, 1, -0.000793219, 0.200576, 0.182067)

[node name="ZZZParticles" type="GPUParticles3D" parent="Activities/BedActivity"]
transform = Transform3D(0.999999, 0, 0, 0, 0.999999, 0, 1.49012e-07, 0, 1, -0.0305171, 0.477519, -0.313852)
emitting = false
amount = 4
lifetime = 1.2
visibility_aabb = AABB(-0.586999, -0.965922, -1.08275, 1.174, 1.93182, 2.16551)
transform_align = 3
trail_lifetime = 0.8
process_material = SubResource("ParticleProcessMaterial_v047h")
draw_pass_1 = SubResource("TextMesh_5yyk0")

[node name="bed" parent="Activities/BedActivity" instance=ExtResource("9_cqd85")]
transform = Transform3D(0.45, 0, 7.45058e-08, 0, 0.45, 0, -7.45058e-08, 0, 0.45, 2.38419e-07, -0.0975402, -0.0288435)

[node name="BedActivity2" type="Node3D" parent="Activities"]
transform = Transform3D(0.613582, 0, 0.789631, 0, 1, 0, -0.789631, 0, 0.613582, 0.94659, 0.1, -1.70343)
script = ExtResource("4_a3onc")

[node name="START_POINT" type="Node3D" parent="Activities/BedActivity2"]
transform = Transform3D(0.999999, 0, -3.8743e-07, 0, 0.999999, 0, 8.9407e-08, 0, 0.999999, -0.644564, -0.0831673, 0.261748)

[node name="ACTIVITY_POINT" type="Node3D" parent="Activities/BedActivity2"]
transform = Transform3D(1, 0, -2.38419e-07, 0, 1, 0, 5.96046e-08, 0, 1, -0.000793219, 0.200576, 0.182067)

[node name="ZZZParticles" type="GPUParticles3D" parent="Activities/BedActivity2"]
transform = Transform3D(0.999999, 0, 0, 0, 0.999999, 0, 1.49012e-07, 0, 1, -0.0305171, 0.477519, -0.313852)
emitting = false
amount = 4
lifetime = 1.2
visibility_aabb = AABB(-0.586999, -0.965922, -1.08275, 1.174, 1.93182, 2.16551)
transform_align = 3
trail_lifetime = 0.8
process_material = SubResource("ParticleProcessMaterial_v047h")
draw_pass_1 = SubResource("TextMesh_5yyk0")

[node name="bed" parent="Activities/BedActivity2" instance=ExtResource("9_cqd85")]
transform = Transform3D(0.45, 0, 7.45058e-08, 0, 0.45, 0, -7.45058e-08, 0, 0.45, 2.38419e-07, -0.0975402, -0.0288435)

[node name="BedActivity3" type="Node3D" parent="Activities"]
transform = Transform3D(-0.289383, 0, 0.957213, 0, 1, 0, -0.957213, 0, -0.289383, -2.41562, 0.111173, 0.00885308)
script = ExtResource("4_a3onc")

[node name="START_POINT" type="Node3D" parent="Activities/BedActivity3"]
transform = Transform3D(0.999999, 0, -3.8743e-07, 0, 0.999999, 0, 8.9407e-08, 0, 0.999999, -0.644564, -0.0831673, 0.261748)

[node name="ACTIVITY_POINT" type="Node3D" parent="Activities/BedActivity3"]
transform = Transform3D(1, 0, -2.38419e-07, 0, 1, 0, 5.96046e-08, 0, 1, -0.000793219, 0.200576, 0.182067)

[node name="ZZZParticles" type="GPUParticles3D" parent="Activities/BedActivity3"]
transform = Transform3D(0.999999, 0, 0, 0, 0.999999, 0, 1.49012e-07, 0, 1, -0.0305171, 0.477519, -0.313852)
emitting = false
amount = 4
lifetime = 1.2
visibility_aabb = AABB(-0.586999, -0.965922, -1.08275, 1.174, 1.93182, 2.16551)
transform_align = 3
trail_lifetime = 0.8
process_material = SubResource("ParticleProcessMaterial_v047h")
draw_pass_1 = SubResource("TextMesh_5yyk0")

[node name="bed" parent="Activities/BedActivity3" instance=ExtResource("9_cqd85")]
transform = Transform3D(0.45, 0, 7.45058e-08, 0, 0.45, 0, -7.45058e-08, 0, 0.45, 2.38419e-07, -0.0975402, -0.0288435)

[node name="BedActivity4" type="Node3D" parent="Activities"]
transform = Transform3D(-0.633029, 0, -0.774128, 0, 1, 0, 0.774128, 0, -0.633029, -1.27213, 0.1, 2.68348)
script = ExtResource("4_a3onc")

[node name="START_POINT" type="Node3D" parent="Activities/BedActivity4"]
transform = Transform3D(0.999999, 0, -3.8743e-07, 0, 0.999999, 0, 8.9407e-08, 0, 0.999999, 0.778622, -0.0831673, 0.261748)

[node name="ACTIVITY_POINT" type="Node3D" parent="Activities/BedActivity4"]
transform = Transform3D(1, 0, -2.38419e-07, 0, 1, 0, 5.96046e-08, 0, 1, -0.000793219, 0.200576, 0.182067)

[node name="ZZZParticles" type="GPUParticles3D" parent="Activities/BedActivity4"]
transform = Transform3D(0.999999, 0, 0, 0, 0.999999, 0, 1.49012e-07, 0, 1, -0.0305171, 0.477519, -0.313852)
emitting = false
amount = 4
lifetime = 1.2
visibility_aabb = AABB(-0.586999, -0.965922, -1.08275, 1.174, 1.93182, 2.16551)
transform_align = 3
trail_lifetime = 0.8
process_material = SubResource("ParticleProcessMaterial_v047h")
draw_pass_1 = SubResource("TextMesh_5yyk0")

[node name="bed" parent="Activities/BedActivity4" instance=ExtResource("9_cqd85")]
transform = Transform3D(0.45, 0, 7.45058e-08, 0, 0.45, 0, -7.45058e-08, 0, 0.45, 2.38419e-07, -0.0975402, -0.0288435)

[node name="LeavePoint" type="MeshInstance3D" parent="Activities"]
transform = Transform3D(0.613582, 0, 0.789631, 0, 1, 0, -0.789631, 0, 0.613582, -0.459597, 0, -2.88418)
script = ExtResource("6_pdokr")

[node name="START_POINT" type="Node3D" parent="Activities/LeavePoint"]

[node name="ACTIVITY_POINT" type="Node3D" parent="Activities/LeavePoint"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -10, 0)

[node name="Requests" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("6_abixe")

[node name="Timers" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("2_dls8v")

[node name="Adventurers" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("3_q8kab")

[node name="Agents" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("4_uo78h")

[node name="UI" parent="." instance=ExtResource("6_xnocw")]

[node name="SCENE_CAM" type="Camera3D" parent="."]
transform = Transform3D(0.752082, -0.437961, 0.492507, 1.49012e-08, 0.747276, 0.664513, -0.65907, -0.499768, 0.562013, 3.18393, 4.02101, 3.68818)
environment = SubResource("Environment_wun1a")
current = true
fov = 70.8
size = 3.65732

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.73392, 2.29661e-07, -0.679236, 0.63007, 0.373538, 0.680795, 0.253721, -0.927615, 0.274147, 0, 3.7599, 1.23124)
light_color = Color(0.682353, 0.768627, 0.968627, 1)
light_energy = 1.15
shadow_enabled = true
shadow_bias = 0.056
shadow_normal_bias = 2.531
shadow_transmittance_bias = -9.72
shadow_opacity = 0.6
shadow_blur = 2.15
directional_shadow_mode = 1
directional_shadow_split_1 = 0.254
directional_shadow_fade_start = 1.0
directional_shadow_max_distance = 8.8
directional_shadow_pancake_size = 4.2

[node name="MAP_OBJECTS" type="Node3D" parent="."]

[node name="COLLISIONS" type="NavigationRegion3D" parent="MAP_OBJECTS"]
navigation_mesh = SubResource("NavigationMesh_av4e2")

[node name="MeshInstance3D" type="MeshInstance3D" parent="MAP_OBJECTS/COLLISIONS"]
transform = Transform3D(10, 0, 0, 0, 10, 0, 0, 0, 10, 0, 0, 0)
mesh = SubResource("PlaneMesh_wambb")
skeleton = NodePath("../../..")

[node name="ObstacleCube1" type="MeshInstance3D" parent="MAP_OBJECTS/COLLISIONS"]
transform = Transform3D(0.609733, 0, -0.498952, 0, 1, 0, 0.4291, 0, 0.708989, -0.143541, -1.43051e-06, 1.71402)
mesh = SubResource("BoxMesh_0jipx")
skeleton = NodePath("")
surface_material_override/0 = SubResource("StandardMaterial3D_8m8ew")

[node name="ObstacleCube2" type="MeshInstance3D" parent="MAP_OBJECTS/COLLISIONS"]
transform = Transform3D(0.817788, 0, -0.575519, 0, 1, 0, 0.575519, 0, 0.817788, 2.00375, -4.76837e-07, 1.10703)
mesh = SubResource("BoxMesh_0jipx")
skeleton = NodePath("")
surface_material_override/0 = SubResource("StandardMaterial3D_8m8ew")

[node name="ObstacleCube4" type="MeshInstance3D" parent="MAP_OBJECTS/COLLISIONS"]
transform = Transform3D(0.609733, 0, -0.498952, 0, 1, 0, 0.4291, 0, 0.708989, 1.66733, -1.90735e-06, -2.60774)
mesh = SubResource("BoxMesh_0jipx")
skeleton = NodePath("")
surface_material_override/0 = SubResource("StandardMaterial3D_8m8ew")

[node name="dining_table" parent="MAP_OBJECTS/COLLISIONS" instance=ExtResource("17_1jl0l")]
transform = Transform3D(0.979113, 0, -0.203317, 0, 1, 0, 0.203317, 0, 0.979113, -1.22314, 0, -2.72446)

[node name="FURNITURE_NO_COL" type="Node3D" parent="MAP_OBJECTS"]
transform = Transform3D(0.979113, 0, -0.203317, 0, 1, 0, 0.203317, 0, 0.979113, -0.468931, 0, 0.800919)

[node name="chair" parent="MAP_OBJECTS/FURNITURE_NO_COL" instance=ExtResource("16_d6hij")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -1.0704, 0, -2.55894)

[node name="chair2" parent="MAP_OBJECTS/FURNITURE_NO_COL" instance=ExtResource("16_d6hij")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -1.84933, 0, -2.55894)

[node name="chair3" parent="MAP_OBJECTS/FURNITURE_NO_COL" instance=ExtResource("16_d6hij")]
transform = Transform3D(1.31134e-07, 0, -1, 0, 1, 0, 1, 0, 1.31134e-07, -1.0704, 0, -4.049)

[node name="chair4" parent="MAP_OBJECTS/FURNITURE_NO_COL" instance=ExtResource("16_d6hij")]
transform = Transform3D(1.31134e-07, 0, -1, 0, 1, 0, 1, 0, 1.31134e-07, -1.84933, 0, -4.049)

[connection signal="load_game" from="DataStore" to="Game" method="_on_load_game"]
[connection signal="load_game" from="DataStore" to="Activities" method="_on_load_game"]
[connection signal="load_game" from="DataStore" to="Requests" method="_on_load_game"]
[connection signal="load_game" from="DataStore" to="Timers" method="_on_load_game"]
[connection signal="load_game" from="DataStore" to="Adventurers" method="_on_load_game"]
[connection signal="load_game" from="DataStore" to="Agents" method="_on_load_game"]
[connection signal="save_game" from="DataStore" to="Game" method="_on_save_game"]
[connection signal="save_game" from="DataStore" to="Activities" method="_on_save_game"]
[connection signal="save_game" from="DataStore" to="Requests" method="_on_save_game"]
[connection signal="save_game" from="DataStore" to="Timers" method="_on_save_game"]
[connection signal="save_game" from="DataStore" to="Adventurers" method="_on_save_game"]
[connection signal="save_game" from="DataStore" to="Agents" method="_on_save_game"]
